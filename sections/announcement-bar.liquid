{%- include 'function.agent' -%}
{%- liquid
  assign store = request.host | split: '.' | first | split: '-' | last
  assign announcement_text = section.settings.announcement_text
-%}

<div
  data-component='announcementBar'
  data-customer-id='{{- customer.id -}}'
  data-customer-secret='{{- customer.metafields.functions.secret -}}'
  data-store='{{- store -}}'
  data-selected-store-customer='{{- customer.metafields.agent.selected_store_customer -}}'
  class='bg-black text-white text-detailed py-3 {% if announcement_text == blank and agent == false -%}hidden lg:flex{%- else -%}flex{%- endif -%}'
>
  {{ customer.metafield }}
  <div class='container-content-wide flex {% if agent -%}justify-center{%- else -%}justify-between{%- endif %}'>
    {%- unless agent -%}
      {%- render 'country-select' -%}
    {%- endunless -%}

    {%- if announcement_text != blank and agent == false -%}
      <p class='flex-1 text-center'>
        {{- announcement_text | upcase -}}
      </p>
    {%- endif -%}

    {%- if agent -%}
      <div class='absolute mx-auto'>
        {%- render 'select',
          placeholder: 'general.header.select_customer',
          attributes: 'data-select-customer',
          class: 'w-[110px] h-[1.4em]'
        -%}
      </div>
    {%- endif -%}

    {%- if customer -%}
      <a href='/account' class='flex-1 text-right hidden md:block'>
        {{- 'general.header.account' | t -}}
      </a>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Announcement bar",
  "settings": [
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement Text"
    }
  ]
}
{% endschema %}
