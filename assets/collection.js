(()=>{"use strict";const e=window.component(((e,t)=>{const n=e,r={name:"main-collection",grid:"[data-product-grid]",loading:"[data-filter-loading]",controls:"[data-filter-controls]",selectedFilters:"[data-fiter-selected]"};n.querySelector(r.controls).addEventListener("input",((e,t=300)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>{e.apply(void 0,r)}),t)}})((e=>((e,t)=>{e.preventDefault();(async(e,t)=>{window.app.emit(["filter:loading"]);const n=await(async e=>fetch(e).then((e=>e.text())).then((e=>(new DOMParser).parseFromString(e,"text/html"))))(`${window.location.origin+window.location.pathname}?section_id=${t.name}&${e}`);window.app.emit(["filter:render"],{html:n,uri:e})})(new URLSearchParams(new FormData(e.target.closest("form"))).toString(),t)})(e,r))));const o=e=>{n.querySelector(r.loading).style.opacity=e?1:0};t.on("filter:render",(({html:e,uri:t})=>{var o;n.querySelector(r.grid).innerHTML=e.querySelector(r.grid).innerHTML,n.querySelector(r.controls).innerHTML=e.querySelector(r.controls).innerHTML,n.querySelector(r.selectedFilters).innerHTML=e.querySelector(r.selectedFilters).innerHTML,o=t,history.pushState({searchParams:o},"",`${window.location.pathname}${o.includes("?")?o:"?".concat(o)}`),window.app.mount(),window.app.emit(["filter:loaded"])})),t.on("filter:loading",(()=>o(!0))),t.on("filter:loaded",(()=>o(!1)))})),t=e=>{let t,n;const r=window.location.search.substring(1).split("&");for(t=0;t<r.length;t++)if(n=r[t].split("="),n[0]===e)return parseInt(n[1],0);return 1},n={collectionFilter:e,mainCollection:window.component(((e,n)=>{const{filters:r,openFilterBtn:o,closeFiltersBtn:i,loadMore:a,productGrid:l}=function(e=document.body,t){const n=[...e.querySelectorAll(t?`[class*="${t}"]`:"*")],r=t?"classList":"dataset";return n.reduce(((e,n)=>([].slice.call(t?n[r]:Object.entries(n[r])).forEach((r=>{let o;t&&r.slice(0,t.length)===t?o=r.slice(t.length,r.length):t||([o]=r),o&&(e[o]=e.hasOwnProperty(o)?e[o].constructor===Array?e[o].concat(n):[e[o],n]:n)})),e)),{})}(e,null),c=document.getElementsByTagName("body")[0],s=()=>{c.classList.toggle("overflow-hidden"),e.classList.toggle("filters_opened"),r.classList.toggle("filters_opened")};o.addEventListener("click",s),i.addEventListener("click",s);const d=async e=>{const n=t("page"),r=e||n+1,o=new URLSearchParams(window.location.search);o.set("page",r);const i=o.toString(),l=await(async e=>fetch(e).then((e=>e.text())).then((e=>(new DOMParser).parseFromString(e,"text/html"))))(`${window.location.origin+window.location.pathname}?section_id=main-collection&${i}`);if(a.classList.add("opacity-0"),l.querySelector("[data-empty]"))return;const c=1!==n;window.app.emit(["filter:render"],{html:l,uri:i,addProducts:!c})},w=new IntersectionObserver((e=>{e.forEach((async e=>{e.isIntersecting&&(a.classList.remove("active"),d())}))}),{rootMargin:"0px",threshold:0});a&&w.observe(a),1!==t("page")&&window.addEventListener("load",(()=>{d(1),setTimeout((()=>window.scrollTo(0,0)),100)})),n.on("filter:render",(({html:e,uri:t,addProducts:n=!1})=>{var r;n?l.innerHTML+=e.querySelector("[data-product-grid]").innerHTML:l.innerHTML=e.querySelector("[data-product-grid]").innerHTML,r=t,history.pushState({searchParams:r},"",`${window.location.pathname}${r.includes("?")?r:"?".concat(r)}`),window.app.mount()}))}))};window.app.add(n),window.app.mount()})();