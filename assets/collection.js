(()=>{"use strict";const e=async e=>fetch(e).then((e=>e.text())).then((e=>(new DOMParser).parseFromString(e,"text/html"))),t=e=>history.pushState({searchParams:e},"",`${window.location.pathname}${e.includes("?")?e:"?".concat(e)}`),n="[data-input]",o=window.component(((o,r)=>{const i=()=>{const t=o.querySelector("[data-clear-all-filters-btn]");t&&t.addEventListener("click",(async t=>{t.preventDefault(),r.emit("product:loading",null,{isLoading:!0});const n=await e(`${window.location.origin+window.location.pathname}?section_id=${o.dataset.sectionId}`);window.app.emit(["filter:render"],{html:n,uri:""})}))};i();const a=()=>{o.querySelectorAll(n).forEach((t=>t.addEventListener("change",(t=>{var n;r.emit("product:loading",null,{isLoading:!0}),n=o,(async(t,n)=>{const o=await e(`${window.location.origin+window.location.pathname}?section_id=${n.dataset.sectionId}&${t}`);window.app.emit(["filter:render"],{html:o,uri:t})})(new URLSearchParams(new FormData(t.target.closest("form"))).toString(),n)}))))};a();const c=()=>{o.querySelectorAll("[data-active-filter]").forEach((e=>e.addEventListener("click",(e=>{o.querySelector(`#${e.currentTarget.dataset.activeFilter}[data-input]`).click()}))))};c();const l=()=>{o.querySelectorAll("[data-clear-filter]").forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=e.currentTarget.dataset.clearFilter,n=o.querySelectorAll(`[data-input][id*='${t}']`);n.forEach((e=>{e.checked=!1}));const r=new Event("change");n[0].dispatchEvent(r)}))))};l(),r.on("filter:render",(({html:e,uri:n})=>{r.emit("product:update",null,{html:e}),((e,t)=>{o.querySelector(e).innerHTML=t.querySelector(e).innerHTML})("[data-filters-form]",e),i(),a(),c(),l(),t(n),r.emit("product:loading",null,{isLoading:!1}),window.app.mount()}))})),r=e=>{let t,n;const o=window.location.search.substring(1).split("&");for(t=0;t<o.length;t++)if(n=o[t].split("="),n[0]===e)return parseInt(n[1],0);return 1},i={collectionFilter:o,mainCollection:window.component(((n,o)=>{const{overlay:i,openFilterBtn:a,closeFiltersBtn:c,loadMore:l,productGrid:s}=function(e=document.body,t){const n=[...e.querySelectorAll(t?`[class*="${t}"]`:"*")],o=t?"classList":"dataset";return n.reduce(((e,n)=>([].slice.call(t?n[o]:Object.entries(n[o])).forEach((o=>{let r;t&&o.slice(0,t.length)===t?r=o.slice(t.length,o.length):t||([r]=o),r&&(e[r]=e.hasOwnProperty(r)?e[r].constructor===Array?e[r].concat(n):[e[r],n]:n)})),e)),{})}(n,null),d=document.getElementsByTagName("body")[0],u="[data-product-grid]";o.on("product:update",((e,{html:t})=>{n.querySelector(u).innerHTML=t.querySelector(u).innerHTML}));const p=e=>{e.preventDefault(),d.classList.toggle("overflow-hidden"),n.classList.toggle("filters_opened")};a.addEventListener("click",p),c.addEventListener("click",p),i.addEventListener("click",p);const w=async t=>{const n=r("page"),o=t||n+1,i=new URLSearchParams(window.location.search);i.set("page",o);const a=i.toString(),c=await e(`${window.location.origin+window.location.pathname}?section_id=main-collection&${a}`);if(l.classList.add("opacity-0"),c.querySelector("[data-empty]"))return;const s=1===o;window.app.emit(["product:render"],{html:c,uri:a,addProducts:!s})},m=new IntersectionObserver((e=>{e.forEach((async e=>{e.isIntersecting&&(l.classList.remove("active"),w())}))}),{rootMargin:"0px",threshold:0});l&&m.observe(l),1!==r("page")&&window.addEventListener("load",(()=>{w(1),setTimeout((()=>window.scrollTo(0,0)),100)})),o.on("product:render",(({html:e,uri:n,addProducts:o=!1})=>{o?s.innerHTML+=e.querySelector(u).innerHTML:s.innerHTML=e.querySelector(u).innerHTML,t(n),window.app.mount()})),o.on("product:loading",((e,{isLoading:t})=>{n.classList[t?"add":"remove"]("pointer-events-none","opacity-50")}))}))};window.app.add(i),window.app.mount()})();