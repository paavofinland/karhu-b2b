(()=>{"use strict";function e(e=document.body,t){const d=[...e.querySelectorAll(t?`[class*="${t}"]`:"*")],s=t?"classList":"dataset";return d.reduce(((e,d)=>([].slice.call(t?d[s]:Object.entries(d[s])).forEach((s=>{let n;t&&s.slice(0,t.length)===t?n=s.slice(t.length,s.length):t||([n]=s),n&&(e[n]=e.hasOwnProperty(n)?e[n].constructor===Array?e[n].concat(d):[e[n],d]:d)})),e)),{})}const t=window.component((t=>{const{loginForm:d,recoverPasswordForm:s,toggleRecoverPasswordBtns:n,recoverMessageSent:c,recoverPasswordSuccess:a,emailList:r}=e(t,null),o=()=>{d.classList.toggle("hidden"),s.classList.toggle("hidden")};n.forEach((e=>{e.addEventListener("click",o)}));const i=()=>{const e=document.querySelector(".errors");e&&(e.style.display="none")};r.forEach((e=>{e.addEventListener("focus",i),e.addEventListener("keyup",i)})),(()=>{const{hash:e}=window.location;return"#recover"===e})()&&!c&&o(),c&&(d.classList.add("hidden"),s.classList.add("hidden"),a.classList.remove("hidden"))})),d=window.component((t=>{const{addAddressButton:d,resetPageButton:s,editAddressButton:n,addAddress:c,info:a,addresses:r,editAddresses:o,editAddressForm:i,makeDefaultButton:l,links:u}=e(t,null),m=e=>{e.preventDefault(),a.classList.remove("hidden"),r.classList.remove("hidden"),c.classList.add("hidden"),o.classList.add("hidden"),[].concat(i).forEach((e=>e.classList.add("hidden"))),window.scrollTo(0,0)};d&&d.addEventListener("click",(e=>{e.preventDefault(),c.classList.remove("hidden"),a.classList.add("hidden"),r.classList.add("hidden"),window.scrollTo(0,0)})),s&&[].concat(s).forEach((e=>{e.addEventListener("click",m)})),n&&[].concat(n).forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const{addressId:d}=e.dataset;r.classList.add("hidden"),a.classList.add("hidden");const s=[].concat(i).find((e=>e.dataset.addressId===d));o.classList.remove("hidden"),s.classList.remove("hidden"),window.scrollTo(0,0)}))})),l&&[].concat(l).forEach((e=>{e.addEventListener("click",(e=>{const{addressId:t}=e.target.dataset,d=i.find((e=>e.dataset.addressId===t)).querySelector("form");d.querySelector('input[type="checkbox"]').click(),d.submit()}))})),window.location.href.includes("carts")&&u.forEach((e=>{const t=e.href.includes("carts");e.parentNode.classList[t?"remove":"add"]("text-grey-4")}))})),s=window.component((t=>{const{deleteAddressButton:d,deleteAddressModal:s,closeModal:n,deleteAddressConfirm:c}=e(t,null);n&&[].concat(n).forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),s.classList.remove("open")})))),d&&d.addEventListener("click",(e=>{e.preventDefault(),s.classList.add("open")})),c&&c.addEventListener("click",(()=>{document.getElementById(`delete-address-form--${c.dataset.addressId}`).submit()}))})),n={orderNumber:"Order number",date:"Date",paymentStatus:"Payment Status",orderStatus:"Order Status",price:"Price"},c={login:t,account:d,address:s,orders:window.component((async(t,d)=>{const{selectCustomer:s,ordersContainer:c,noOrders:a,customerSelectText:r,ordersTable:o,ordersBlock:i}=e(t,null);let l={};const u=()=>{const e=document.createElement("button");return e.innerText="View details",e.classList.add("underline"),e},m=async e=>{const t=await(async e=>{const{store:t,customerSecret:d,customerId:s}=l,n=new URLSearchParams({store:t,secret:d,customerId:s,selectedCustomerId:e?.target.value||""});return fetch(`https://karhu-b2b-functions.vercel.app/api/order/get-store-customer-orders?${n}`).then((async e=>200===e.status?e.json():(console.error(`Could not fetch customer orders [${(await e.json()).message}]`),[])))})(e);r&&r.classList.add("hidden"),t.length?(c.classList.remove("hidden"),(e=>{const t=document.createDocumentFragment();e.forEach((e=>{const d=document.createElement("tr");Object.keys(n).forEach((t=>{const s=document.createElement("td");s.innerText=e[t],s.classList.add("py-7"),d.appendChild(s)}));const s=document.createElement("td"),c=u();s.appendChild(c),s.classList.add("py-7"),d.classList.add("border-b","border-grey-5"),d.appendChild(s),t.appendChild(d)})),o.appendChild(t)})(t),(e=>{const t=document.createDocumentFragment();e.forEach((e=>{const d=document.createElement("div");d.classList.add("grid","grid-cols-2","gap-4","py-10"),Object.entries(n).forEach((([t,s])=>{const n=document.createElement("div"),c=document.createElement("p"),a=document.createElement("p");a.classList.add("text-heading-7"),a.innerText=s,c.innerText=e[t],n.appendChild(a),n.appendChild(c),d.appendChild(n)}));const s=document.createElement("div"),c=document.createElement("p");c.innerText="View details";const a=u();s.appendChild(c),s.appendChild(a),d.appendChild(s),t.appendChild(d)})),i.appendChild(t)})(t)):a.classList.remove("hidden")};s?(s.addEventListener("change",m),d.on("agent-stores:received",(({data:e})=>{(e=>{const t=document.createDocumentFragment();e.forEach((e=>{const d=document.createElement("option");d.value=e.id,d.innerText=e.name,t.appendChild(d)})),s.appendChild(t)})(e)}))):m(),d.on("store-data:send",(e=>{l=e}))}))};window.app.add(c),window.app.mount()})();