(()=>{"use strict";function e(e=document.body,t){const s=[...e.querySelectorAll(t?`[class*="${t}"]`:"*")],d=t?"classList":"dataset";return s.reduce(((e,s)=>([].slice.call(t?s[d]:Object.entries(s[d])).forEach((d=>{let n;t&&d.slice(0,t.length)===t?n=d.slice(t.length,d.length):t||([n]=d),n&&(e[n]=e.hasOwnProperty(n)?e[n].constructor===Array?e[n].concat(s):[e[n],s]:s)})),e)),{})}const t={login:window.component((t=>{const{loginForm:s,recoverPasswordForm:d,toggleRecoverPasswordBtns:n,recoverMessageSent:o,recoverPasswordSuccess:c,emailList:r}=e(t,null),a=()=>{s.classList.toggle("hidden"),d.classList.toggle("hidden")};n.forEach((e=>{e.addEventListener("click",a)}));const i=()=>{const e=document.querySelector(".errors");e&&(e.style.display="none")};r.forEach((e=>{e.addEventListener("focus",i),e.addEventListener("keyup",i)})),(()=>{const{hash:e}=window.location;return"#recover"===e})()&&!o&&a(),o&&(s.classList.add("hidden"),d.classList.add("hidden"),c.classList.remove("hidden"))})),account:window.component((t=>{const{addAddressButton:s,resetPageButton:d,editAddressButton:n,addAddress:o,info:c,addresses:r,editAddresses:a,editAddressForm:i,makeDefaultButton:l,links:u}=e(t,null),h=e=>{e.preventDefault(),c.classList.remove("hidden"),r.classList.remove("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),[].concat(i).forEach((e=>e.classList.add("hidden"))),window.scrollTo(0,0)};s&&s.addEventListener("click",(e=>{e.preventDefault(),o.classList.remove("hidden"),c.classList.add("hidden"),r.classList.add("hidden"),window.scrollTo(0,0)})),d&&[].concat(d).forEach((e=>{e.addEventListener("click",h)})),n&&[].concat(n).forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const{addressId:s}=e.dataset;r.classList.add("hidden"),c.classList.add("hidden");const d=[].concat(i).find((e=>e.dataset.addressId===s));a.classList.remove("hidden"),d.classList.remove("hidden"),window.scrollTo(0,0)}))})),l&&[].concat(l).forEach((e=>{e.addEventListener("click",(e=>{const{addressId:t}=e.target.dataset,s=i.find((e=>e.dataset.addressId===t)).querySelector("form");s.querySelector('input[type="checkbox"]').click(),s.submit()}))})),window.location.href.includes("carts")&&u.forEach((e=>{const t=e.href.includes("carts");e.parentNode.classList[t?"remove":"add"]("text-grey-4")}))})),address:window.component((t=>{const{deleteAddressButton:s,deleteAddressModal:d,closeModal:n,deleteAddressConfirm:o}=e(t,null);n&&[].concat(n).forEach((e=>e.addEventListener("click",(e=>{e.preventDefault(),d.classList.remove("open")})))),s&&s.addEventListener("click",(e=>{e.preventDefault(),d.classList.add("open")})),o&&o.addEventListener("click",(()=>{document.getElementById(`delete-address-form--${o.dataset.addressId}`).submit()}))})),orders:window.component((async(t,s)=>{const{selectCustomer:d,ordersContainer:n,noOrders:o,customerSelectText:c,ordersTable:r,ordersTableRow:a,ordersBlockContainer:i,ordersBlock:l}=e(t,null);let u={};const h=({container:t,containerItem:s,orderList:d})=>{t.innerHTML="";const n=document.createDocumentFragment();d.forEach((t=>{const d=s.content.cloneNode(!0);Object.keys(t).forEach((s=>{const n=t[s];[].concat(e(d)[s]).filter(Boolean).forEach((e=>{e.innerText=n}))})),n.appendChild(d)})),t.appendChild(n)},m=async e=>{const t=await(async e=>{const{store:t,customerSecret:s,customerId:d}=u,n=new URLSearchParams({store:t,secret:s,customerId:d,selectedCustomerId:e?.target.value||""});return fetch(`https://karhu-b2b-functions.vercel.app/api/customer/get-store-customer-orders?${n}`).then((async e=>200===e.status?e.json():(console.error(`Could not fetch customer orders [${(await e.json()).message}]`),[])))})(e);c&&c.classList.add("hidden"),t.length?(n.classList.remove("hidden"),h({container:r,containerItem:a,orderList:t}),h({container:i,containerItem:l,orderList:t})):o.classList.remove("hidden")};d?(d.addEventListener("change",m),s.on("agent-stores:received",((e,{data:t})=>{(e=>{const t=document.createDocumentFragment();e.forEach((e=>{const s=document.createElement("option");s.value=e.id,s.innerText=e.name,t.appendChild(s)})),d.appendChild(t)})(t)}))):m(),s.on("store-data:send",((e,{data:t})=>{u=t}))}))};window.app.add(t),window.app.mount()})();